<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>AniList + GitHub Pages — demo</title>
  <style>
    body{font-family:system-ui,Segoe UI,Roboto,Arial;max-width:800px;margin:32px auto;padding:0 16px}
    .card{display:flex;gap:12px;margin:12px 0;padding:12px;border:1px solid #eee;border-radius:8px}
    img{width:96px;height:auto;border-radius:6px}
  </style>
</head>
<body>
  <h1>AniList search (public data)</h1>
  <input id="q" placeholder="Search anime (e.g. Naruto)" />
  <button id="search">Search</button>
  <div id="results"></div>

  <script>
    const query = `
      query ($search: String) {
        Media(search: $search, type: ANIME) {
          id
          title { romaji english native }
          coverImage { large }
          description(asHtml: false)
          episodes
          averageScore
        }
      }`;

    async function search(q){
      const res = await fetch('https://graphql.anilist.co', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Accept': 'application/json'
        },
        body: JSON.stringify({ query, variables: { search: q } })
      });

      if (!res.ok){
        const text = await res.text();
        throw new Error(`HTTP ${res.status}: ${text}`);
      }

      const payload = await res.json();
      return payload.data && payload.data.Media ? payload.data.Media : null;
    }

    document.getElementById('search').addEventListener('click', async ()=>{
      const q = document.getElementById('q').value.trim();
      const results = document.getElementById('results');
      results.innerHTML = 'Loading...';
      try {
        const media = await search(q);
        if(!media){ results.innerHTML = 'No results.'; return; }
        results.innerHTML = `
          <div class="card">
            <img src="${media.coverImage.large}" alt="cover"/>
            <div>
              <h3>${media.title.english || media.title.romaji}</h3>
              <p>Episodes: ${media.episodes ?? '—'} • Score: ${media.averageScore ?? '—'}</p>
              <p style="max-height:5.4em;overflow:hidden">${(media.description || '').replace(/<\/?[^>]+(>|$)/g, '')}</p>
            </div>
          </div>
        `;
      } catch (err) {
        results.innerHTML = `<pre style="color:crimson">${err.message}</pre>`;
        console.error(err);
      }
    });
  </script>
</body>
</html>
